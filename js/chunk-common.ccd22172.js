(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"0f63":function(e,t,n){},1919:function(e,t,n){},"1cfc":function(e,t,n){},3921:function(e,t,n){},"3c43":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensure=o,t.notifyError=r,t.ensureAndNotify=a,t.assume=l,t.notImplemented=c,t.LoadError=t.NotAuthorized=t.PreCondition=t.FormatError=t.NetworkError=t.ParseError=t.NotImplemented=t.TokenExpired=t.GeneralError=t.AlreadyExists=t.ParamValue=t.DoesNotExist=t.MissingParam=void 0;var i=s(n("2b0e"));function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){if(!e){var i=new Error(n);throw i.error=t,i.code=t,console.error("ENSURE ERROR",t,n),i}}function r(e){i["default"].prototype.$q.notify({message:e,color:"red",icon:"error"})}function a(e,t,n){e||(i["default"].prototype.$q.notify({message:n,color:"red",icon:"error"}),o(e,t,n))}function l(e,t){if(!e)throw console.error("ASSUMPTION FAILED",t||"no message"),{error:"assumption-fail",message:t}}function c(){o(!1,y,"This feature is not implemented")}var u="missing-param";t.MissingParam=u;var d="does-not-exist";t.DoesNotExist=d;var p="param-value";t.ParamValue=p;var h="already-exists";t.AlreadyExists=h;var m="general-error";t.GeneralError=m;var f="token expired";t.TokenExpired=f;var y="not-implemented";t.NotImplemented=y;var g="parse-error";t.ParseError=g;var v="network-error";t.NetworkError=v;var x="format-error";t.FormatError=x;var b="pre-condition";t.PreCondition=b;var S="not-authorized";t.NotAuthorized=S;var $="load-error";t.LoadError=$},"6b3d":function(e,t,n){"use strict";var i=n("c8ba0"),s=n.n(i);s.a},"748a":function(e,t,n){},7581:function(e,t,n){},"75ba":function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return l}));var i=n("1cb6"),s=n("7996");function o(){const e="$"+(Number(new Date)-new Date("2020-01-01")+Math.random()).toString(36).replace(".","");return e}function r(e,t){const n=e.spec;if(t=t||n.show,"string"===typeof t&&(t=t.split(",").map(e=>e.trim())),Array.isArray(t)&&t.length>0)return t.filter(e=>"string"===typeof e).map(t=>({name:t,value:e.child(t).value}));const i=e.value;return"object"===typeof i&&i&&e.expectedSpec.hashSpec?Object.keys(i).map(t=>({name:t,value:e.child(t).value})):[]}function a(e="Natura Script"){Object(i["a"])("feedback","send","sendFeedback",1),window.open("mailto:elshor@gmail.com?subject="+e,"_blank")}function l(e,t={},n){return Object(s["d"])(e,t,n)}},"761e":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.user.name?n("q-btn-dropdown",{attrs:{dense:"",flat:"",round:"","auto-close":"",label:e.user.name}},[n("q-list",[n("q-item",{attrs:{clickable:"",dense:""},on:{click:function(t){return e.$store.dispatch("changePassword")}}},[e._v("\n\t\t\tChange password\n\t\t")]),n("q-item",{attrs:{clickable:"",dense:""},on:{click:function(t){return e.$store.dispatch("changeDetails")}}},[e._v("\n\t\t\tChange details\n\t\t")]),n("q-item",{attrs:{dense:"",clickable:""},on:{click:function(t){return e.$store.dispatch("logout")}}},[e._v("\n\t\t\tSign out\n\t\t")])],1)],1):n("q-btn",{attrs:{dense:"",flat:"",round:"",label:"Sign In"},on:{click:function(t){return e.$store.dispatch("login")}}})},s=[],o={data(){return{user:this.$store.state.user}},async mounted(){this.$store.dispatch("trySilentLogin"),this.user=this.$store.state.user}},r=o,a=n("2877"),l=n("9c40"),c=n("f20b"),u=n("1c1c"),d=n("66e5"),p=n("eebe"),h=n.n(p),m=Object(a["a"])(r,i,s,!1,null,null,null);t["a"]=m.exports;h()(m,"components",{QBtn:l["a"],QBtnDropdown:c["a"],QList:u["a"],QItem:d["a"]})},"7e66":function(e,t,n){"use strict";var i=n("0f63"),s=n.n(i);s.a},"81d8":function(e,t,n){},"92da":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var i=n("da50"),s=n("479f"),o=n.n(s),r=n("1cb6");function a(e){return!u(e)}function l(e,t){if(!t)return;t=p(t),Object(i["i"])(t,i["b"],"A guide for this document does not exist"),Object(r["a"])("guide","show",d(e),1);const n=o()();n.setOptions(t),n.onbeforechange((function(){const e=this._currentStep,t=this,n=this._introItems[this._currentStep];if(h(n.expand))return n.expand=null,setTimeout(()=>{n.element=document.querySelector(n.selector),n.element&&t.goToStep(e+1)},100),!1})),n.oncomplete(()=>{c(e,"complete"),Object(r["a"])("guide","complete",d(e),1)}),n.onexit(()=>{c(e,"exit"),Object(r["a"])("guide","exit",d(e),1)}),n.onchange((function(){Object(r["a"])("guide","change",d(e)+":"+this._currentStep,1)})),n.start()}function c(e,t="complete"){const n=localStorage.getItem("guide:"+d(e));"exit"===t&&"complete"===n||localStorage.setItem("guide:"+d(e),t)}function u(e,t="exit"){const n=localStorage.getItem("guide:"+d(e));switch(t){case"complete":return["complete"].includes(n);case"exit":return["complete","exit"].includes(n);default:return!1}}function d(e){if(e&&"object"===typeof e)return e._id||e.$id||e.id}function p(e){if(!e)return{steps:[]};const t=Object.assign({},e);return t.steps=e.steps.map(e=>{const t=Object.assign({},e);return e.selector&&!e.expand?t.element=document.querySelector(e.selector):t.selector=e.selector,t}),t.tooltipClass="text-subtitle1",t}function h(e){if(!e)return!1;const t=document.querySelector(e),n=m(t);return!(!t||"function"!==typeof n.expand)&&(n.expand(),!0)}function m(e){let t=e;while(t){if(t.__vue__)return t.__vue__;t=t.parentNode}return null}},"97a4":function(e,t,n){"use strict";var i=n("7581"),s=n.n(i);s.a},a000:function(e,t,n){"use strict";var i=n("1919"),s=n.n(i);s.a},a897:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("entity",{ref:"entity",attrs:{value:e.doc,spec:e.spec,expanded:!0,"hide-expand-control":!0,"hide-inline-value":!0}})],1)},s=[],o=n("cde4"),r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"edit"===e.mode?n("q-editor",{ref:"editor",staticClass:"richtext-editor",attrs:{placeholder:e.placeholder,value:e.localValue,dense:"","min-height":e.spec.minHeight||e.defaultHeight},on:{blur:e.exitEditMode,input:e.onInput,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:e.exitEditor(t):null},contextmenu:function(e){e.stopPropagation()}}}):n("div",{staticClass:"richtext-viewer",domProps:{innerHTML:e._s(e.value)},on:{click:e.enterEditMode}})},l=[],c=n("12ed"),u={name:"RichtextEditor",props:{value:{required:!0},spec:{type:Object,required:!0}},data(){return{localValue:"",defaultHeight:"5em",mode:"view"}},mounted(){this.localValue=this.value||""},watch:{localValue(e){this.$emit("change",e)},value(e){this.localValue=e}},computed:{placeholder(){return Object(c["b"])(this.spec)}},methods:{exitEditor(){this.$bus("moveToNextElement")},enterEditMode(){return this.mode="edit",this.$nextTick(()=>this.$refs.editor.focus()),!0},exitEditMode(){const e=this;setTimeout(()=>{e.$refs.editor&&document.activeElement.parentNode!==e.$refs.editor.$el&&(this.mode="view")},200)},onInput(e){this.$emit("change",e)}}},d=u,p=(n("c714"),n("2877")),h=n("d66b"),m=n("eebe"),f=n.n(m),y=Object(p["a"])(d,a,l,!1,null,"2805be8e",null),g=y.exports;f()(y,"components",{QEditor:h["a"]});var v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("inline-editor",{attrs:{spec:e.spec,type:e.type,value:e.value,"value-class":e.valueClass,validator:e.validator},on:{change:function(t){return e.$emit("change",t)}}})},x=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("input",{ref:"input",class:{invalid:e.invalid},style:{display:"inline"},attrs:{type:e.inputType,size:"string"===typeof e.value?e.value.length:e.placeholder.length,placeholder:e.placeholder},domProps:{value:e.inputText},on:{focus:e.onFocus,blur:e.onBlur,input:e.onInput,keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.onDelete(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.shiftKey?t.ctrlKey||t.altKey||t.metaKey?null:e.onMoveToPreviousElement(t):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onEnter(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.onUp(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onDown(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:void(e.showSuggestions=!0):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.onEscape(t)},function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onKeyUp(t)}],keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:(t.stopPropagation(),t.preventDefault(),t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onTab(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:t.shiftKey?(t.stopPropagation(),t.preventDefault(),t.ctrlKey||t.altKey||t.metaKey?null:e.onMoveToPreviousField(t)):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onSpace(t)}],dblclick:function(t){return t.stopPropagation(),t.target!==t.currentTarget?null:e.onDblclick(t)},click:function(t){return t.stopPropagation(),e.onClick(t)}}}),n("suggestions-menu",{ref:"suggestions",attrs:{show:e.showSuggestions,filter:e.inputText.toString(),spec:e.spec},on:{change:function(t){return e.onSuggestionSelected("menu")},select:e.onSelectElement,hide:e.onHideSuggestions}})],1)},S=[],$=n("75ba");function w(e){return null===e||void 0===e}function E(e){return e?e.dictionary||E(e.$parent):null}function k(e){return e&&e.$options?e.$options.name:void 0}function _(e,t){if(!e)return null;t=Array.isArray(t)?t:[t];let n=e.$parent;while(n){if(t.includes(k(n)))return n;n=n.$parent}return null}function P(e){return e?k(e)+`(${e?e._uid:"NULL"}): `+T(e).join():"NULL"}function T(e){if(!e)return[];let t=e.$parent;const n=[];while(t)n.push(k(t)),t=t.$parent;return n}function j(e){return["boolean","string","number"].includes(typeof e)}var O=n("71d5"),C={computed:{computedSpec(){return this.location.spec},expectedSpec(){return this.location.expectedSpec},computedType(){return this.computedSpec.type||this.type},path(){return this.location.path},location(){return N(this)},canUseExpression(){return this.location.canUseExpressions},editor(){return _(this,"Editor")}}};function N(e){if(!e)return Object(O["a"])();switch(k(e)){case"Editor":return Object(O["a"])(e.doc||{},E(e));case"PropertyName":return Object(O["a"])();case"ChildElement":return N(e.$parent).child(e.index);case"Property":return N(e.$parent).child(e.name);case"InlineValue":if(e.name)return N(e.$parent).child(e.name);default:return e.parentPath?Object(O["a"])(_(e,"Editor").doc||{},E(e),e.parentPath):N(e.$parent)}}var q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-menu",{ref:"menu",attrs:{value:e.show,anchor:"top left",self:"bottom left","no-focus":!0},on:{hide:e.onHide}},[n("q-item",{staticClass:"menu-title",attrs:{dense:""}},[n("q-item-section",[e.expectedSpec.description?n("q-tooltip",{attrs:{anchor:"center right",self:"center left","max-width":"20em",delay:100}},[n("span",{domProps:{innerHTML:e._s(e.expectedSpec.description)}})]):e._e(),e._v("\n\n\t\t\t"+e._s(e.placeholder)+"\n\t\t")],1),n("q-item-section",{attrs:{side:""}},[n("q-icon",{staticStyle:{transform:"scale(-1,1)"},attrs:{name:"call_made",color:"black"},on:{click:e.onMoveToParent}},[n("q-tooltip",[e._v("Drill-Up")])],1)],1)],1),e.expectElement&&e.editor.frame?n("q-item",{ref:"select-element",staticClass:"select-element",attrs:{clickable:"",dense:""},on:{"!click":function(t){return e.onSelectElement(t)}}},[n("q-item-section",{on:{click:e.onSelectElement}},[e._v("\n\t\t\tSelect element in browser\n\t\t")]),n("q-item-section",{attrs:{side:""}},[n("q-icon",{attrs:{name:"fas fa-hand-pointer"}})],1)],1):e._e(),e.noSuggestions?n("q-item",{attrs:{dense:""}},[n("q-item-section",[e._v("\n\t\t\tThere are no suggestions. Start with '=' for expressions\n\t\t")])],1):e._e(),e._l(e.suggestions.list,(function(t,i){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:i,ref:"suggestionItems",refInFor:!0,staticClass:"suggestion",class:i===e.selected?"bg-blue-grey-2":"",attrs:{clickable:"",dense:""},on:{click:function(t){return e.onClick(t,i)}}},[n("q-item-section",[e.suggestionText(t)?n("span",[e._v("\n\t\t\t\t"+e._s(e.suggestionText(t))+"\n\t\t\t")]):n("span",[e._v("should show template")]),t.description?n("q-tooltip",{ref:"tooltip-"+i,refInFor:!0,attrs:{anchor:"center right",self:"center left","max-width":"20em",value:e.selectedList[i],delay:100}},[n("span",{domProps:{innerHTML:e._s(t.description||"no description")}})]):e._e()],1)],1)}))],2)},M=[],I=n("59ce"),A=n("0831"),V=n("1cb6");const{getScrollTarget:D,setScrollPosition:K}=A["a"];function F(e){if(!e)return;const t=e.$el,n=D(t),i=t.offsetTop,s=200;K(n,i,s)}var Q={name:"SuggestionsMenu",mixins:[C],props:{show:{type:Boolean,default:!1},filter:{type:String,required:!0},spec:{required:!1,type:Object,default:null}},data(){return{selected:0,shouldShow:!0,externalSuggestions:[]}},computed:{expectElement(){return this.location.dictionary.isa("an element",this.expectedSpec.type)},suggestions(){const e=this.filter.startsWith("=")?this.filter.substr(1):this.filter,t=this.filter.startsWith("="),n=Object(I["a"])(this.location,e,null,t);return n.list=this.externalSuggestions.concat(n.list),n},selectedList(){const e=new Array(this.suggestions.length);return e[this.selected]=!0,e},noSuggestions(){return 0===this.suggestions.list.length&&"loading"!==this.suggestions.state},selectedValue(){if(!(0===this.suggestions.list.length||this.selected<0||this.selected>=this.suggestions.list.length))return this.suggestions.list[this.selected].value},typeName(){return Object(c["f"])(this.computedSpec)},placeholder(){return Object(c["b"])(this.location.expectedSpec)}},methods:{onHide(){this.$emit("hide")},onClick(e,t){e.ctrlKey?console.info("selected entry",this.suggestions.list[t]):this.selectSuggestion(t)},onMoveToParent(){this.$bus("moveToParent")},onSelectElement(e){Object(V["a"])("edit","select-element-request"),this.editor.$emit("select-element",this),this.$emit("select",!0),e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation()},selectSuggestion(e){this.selected=e,this.$emit("change",this.selectedValue)},receiveExternalSuggestions(e){Object(V["a"])("edit","selected-element-receive"),this.externalSuggestions=e||[],this.$emit("select",!1)},moveToNextSuggestion(){this.selected++,this.selected===this.suggestions.list.length&&(this.selected=0),this.$refs.suggestionItems&&F(this.$refs.suggestionItems[this.selected])},moveToPreviousSuggestion(){this.selected--,this.selected<0&&(this.selected=this.suggestions.list.length-1),this.$refs.suggestionItems&&F(this.$refs.suggestionItems[this.selected])},suggestionText(e){return e.text?e.text:Object(I["c"])(e.value,this.location.expectedSpec,E(this))}},watch:{suggestions(){this.selected=0},show(e){e&&this.$refs.menu.show()}}},B=Q,L=(n("d5ca"),n("4e73")),H=n("66e5"),U=n("4074"),z=n("05c0"),R=n("0016"),W=n("7f67"),G=Object(p["a"])(B,q,M,!1,null,"4cb851ef",null),Z=G.exports;f()(G,"components",{QMenu:L["a"],QItem:H["a"],QItemSection:U["a"],QTooltip:z["a"],QIcon:R["a"]}),f()(G,"directives",{ClosePopup:W["a"]});var J=n("db49"),X=n("e494"),Y=n("f5ef"),ee=n("da50");function te(e,t){return!!(e&&e.$parent&&ne(e.$parent,t))}function ne(e,t){return k(e)===t}function ie(e){if(!e)return null;const t=e.$parent.$children.filter(ve),n=t.indexOf(e);return t[n+1]}function se(e){if(!e)return null;const t=e.$parent.$children,n=t.indexOf(e);return 0===n?null:t[n-1]}function oe(e){return e&&e.$parent?e.$parent:null}function re(e,t){return e&&"object"===typeof e&&"function"===typeof e[t]}function ae(e){return re(e,"canExpand")&&e.canExpand()}async function le(e,t=!1){const n=oe(e);if(te(e,"InlineValue"))return le(n,t);if("PropertyName"===k(e)){const t=_(e,"Property");Object(ee["h"])(t),ue(t.$refs.inlineValue)}else if(te(e,"InlinePattern")&&ne(ie(e),"InlineValue"))ue(ie(e));else if(te(e,"InlinePattern")&&!ne(ie(e),"InlineValue"))le(n,t);else if((te(e,"Property")||te(e,"ChildElement"))&&ae(n)&&!0!==t)await de(n),Y["a"].$nextTick(()=>pe(n));else if((te(e,"Property")||te(e,"ChildElement"))&&ae(n)){const e=n.location.firstMissingProperty();null!==e&&await ge(n,e)}else if((te(e,"Property")||te(e,"ChildElement"))&&ie(n))ue(ie(n));else if(!te(e,"Property")&&!te(e,"ChildElement")||ie(n))if("InlinePattern"===k(e))le(n,t);else{if("Property"!==k(e))return!1;me(e)}else le(n,t)}function ce(e){const t=oe(e);if(te(e,"InlineValue"))return ce(t);if(te(e,"InlinePattern")&&ne(se(e),"InlineValue"))ue(se(e));else if(te(e,"InlinePattern")&&!ne(se(e),"InlineValue"))ce(t);else if((te(e,"Property")||te(e,"ChildElement"))&&se(t))ue(se(t));else if(!te(e,"Property")&&!te(e,"ChildElement")||se(t))if("InlinePattern"===k(e))ce(t);else{if("PropertyName"!==k(t))throw console.error("not implemented",P(e)),"not-implemented moveToNextField option";ce(t)}else ce(t)}function ue(e){return e.$select(e),!!re(e,"enterEditMode")&&e.enterEditMode()}function de(e){return!!e.expanded||(e.expand(),new Promise(t=>{Y["a"].$once("expanded",({component:n})=>{n===e&&t(!0)})}))}function pe(e){Object(ee["h"])(ne(e,"ChildElement")||ne(e,"Property")),ue(e.firstFieldElement)}function he(e){Object(ee["h"])(e);const t="InlineValue"===k(e)?e:_(e,"InlineValue"),n=_(t,["InlineValue","Property","ChildElement"]);return n.$select(n),n.enterEditMode("reedit"),!0}function me(e,t=!1){const n=k(e);let i=null;if(i="ChildElement"===n||"Property"===n?e:_(e,["Property","ChildElement"]),!i)return i=_(e,"Cell"),i&&i.executeCell(),!1;const s=i.location.firstMissingProperty();return null!==s?(ge(i,s),!0):ie(i)?ue(ie(i)):!0!==t||"ChildElement"!==k(i)?me(oe(i)):(oe(i).pushNewElement(),void Y["a"].$nextTick(()=>me(e)))}function fe(e){const t=k(e);let n=null;return n="ChildElement"===t||"Property"===t?e:_(e,["Property","ChildElement"]),se(n)?ue(se(n)):fe(oe(n))}async function ye(e,t){const n=k(e);if("Property"!==n&&"ChildElement"!==n){const n=e.$parent;if(!n)return e;const i=e.location.path,s=n.location.path,o=i.substr(s.length+1),r=o.length>0?o+"/"+t:t;return ye(n,r)}const i=t.indexOf("/"),s=-1===i?t:t.substring(0,i),o=-1===i?null:t.substring(i+1);await de(e);const r=e.child(s);return r?o?ye(r,o):r:e}async function ge(e,t){const n=await ye(e,t);ue(n)}function ve(e){const t=e.$options.name;return!["QSlideTransition","QTooltip"].includes(t)}Y["a"].$on("moveToNextField",({component:e,noExpand:t})=>le(e,!0===t)),Y["a"].$on("moveToPreviousField",({component:e})=>ce(e)),Y["a"].$on("moveToNextElement",({component:e})=>me(e)),Y["a"].$on("moveToParent",({component:e})=>he(e)),Y["a"].$on("moveToPreviousElement",({component:e})=>{fe(e)});var xe={name:"InlineEditor",mixins:[C],components:{"suggestions-menu":Z},data(){return{canDelete:!1,inputText:"",askShowSuggestions:!1,showSuggestions:!1,waitingForSelectElement:!1}},props:{spec:{required:!1,type:Object,default:null},value:{required:!0},mode:{type:String,required:!1,default:"edit"}},mounted(){const e=w(this.value)?this.generateNewElement():this.value;!Object(c["d"])(this.location.expectedSpec)&&j(e)&&(this.inputText=e),this.canDelete=0===this.inputText.length,"reedit"===this.mode&&(this.askShowSuggestions=!0),Object(c["d"])(this.location.expectedSpec)&&(this.askShowSuggestions=!0),this.$refs.input.focus()},methods:{onHideSuggestions(){this.showSuggestions=!1,this.$refs.input!==document.activeElement&&this.$bus("exitEditMode")},onDblclick(e){this.askShowSuggestions=!1,e.target.select()},onClick(e){1===e.detail&&(this.askShowSuggestions=!this.askShowSuggestions)},onUp(){this.$refs.suggestions.moveToPreviousSuggestion()},onDown(){this.$refs.suggestions.moveToNextSuggestion()},onSelectElement(e){this.waitingForSelectElement=e},onSpace(e){0!==this.inputText.length||this.showSuggestions||(this.askShowSuggestions=!0,e.preventDefault())},onFocus(){setTimeout(()=>{""===this.inputText&&Object(I["b"])(this.location,"")&&(this.askShowSuggestions=!0)},J["d"])},hasPattrenFields(){const e=Object(c["c"])(this.computedSpec);return"string"===typeof e&&Object(X["a"])(e).fields.length>0},onSuggestionSelected(e){const t=this.$refs.suggestions.selectedValue;this.$emit("change",t),this.inputText=Object(I["c"])(t,this.computedSpec,E(this)),this.askShowSuggestions=!1,this.$nextTick(()=>{this.hasPattrenFields()?this.$parent.enterEditMode():(this.$bus("exitEditMode"),"menu"!==e?this.$bus("moveToNextField",{noExpand:!0}):null!==this.location.firstMissingProperty()&&ge(this,this.location.firstMissingProperty()))})},onKeyUp(e){"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopPropagation()},onInput(e){this.inputText=e.target.value.trimStart(),this.inputText.length>0&&(this.canDelete=!1),this.mustSelect&&(this.askShowSuggestions=!0),this.showSuggestions&&(this.filter=this.inputText.toString());const t=this.location.expectedType;this.location.dictionary.isa(t,"number")&&!this.mustSelect||this.location.dictionary.isa(t,"a number")&&!this.mustSelect?this.$emit("change",be(this.inputText)):(this.location.dictionary.isa(t,"string")&&!this.mustSelect||this.location.dictionary.isa(t,"a string")&&!this.mustSelect||"any instance"===t)&&this.$emit("change",this.inputText)},onDelete(e){""===e.target.value&&this.canDelete?(this.$bus("moveToPreviousField"),this.$emit("delete")):0===e.target.value.length&&(this.canDelete=!0)},onEnter(){this.isShowingSuggestion?this.onSuggestionSelected():(this.$bus("exitEditMode"),this.$bus("moveToNextElement"))},onMoveToPreviousElement(){this.$bus("exitEditMode"),this.$bus("moveToPreviousElement")},onMoveToPreviousField(){this.$bus("exitEditMode"),this.$bus("moveToPreviousField")},onTab(){this.isShowingSuggestion?this.onSuggestionSelected():(this.$bus("exitEditMode"),this.$bus("moveToNextField"))},onEscape(){this.$bus("exitEditMode"),this.$bus("moveToParent")},onBlur(){setTimeout(()=>{this.waitingForSelectElement||this.isShowingSuggestion||this.$bus("exitEditMode")},200)},generateNewElement(){return Object($["b"])(this.computedSpec.type,null,E(this))}},watch:{askShowSuggestions(){setTimeout(()=>{this.showSuggestions=this.askShowSuggestions},300)}},computed:{isShowingSuggestion(){return this.showSuggestions&&this.$refs.suggestions&&void 0!==this.$refs.suggestions.selectedValue},displayValue(){return this.usePlaceholder?this.placeholder:this.value},placeholder(){return"reference"===this.computedType?Object(c["b"])(this.expectedSpec):Object(c["b"])(this.spec||this.computedSpec)},inputType(){const e=["date","file","color","email","password","tel","url"];return e.includes(this.computedSpec.type)?this.computedSpec.type:"text"},usePlaceholder(){return"string"===typeof this.value?0===this.value.length:void 0===this.value||null===this.value},mustSelect(){const e=this.location.expectedType;return!!this.computedSpec.options||!this.location.dictionary.isa(e,"string")&&(!this.location.dictionary.isa(e,"a string")&&(!this.location.dictionary.isa(e,"number")&&(!this.location.dictionary.isa(e,"a number")&&"any instance"!==e)))},invalid(){return this.mustSelect&&this.inputText.length>0&&!Object(I["b"])(this.location,this.inputText)}}};function be(e){const t=Number.parseFloat(e);return Number.isNaN(t)?void 0:t}var Se=xe,$e=(n("97a4"),Object(p["a"])(Se,b,S,!1,null,"7f151b42",null)),we=$e.exports,Ee={name:"UrlEditor",components:{"inline-editor":we},props:{spec:{type:Object,required:!0},value:{required:!0},valueClass:{type:String,default:""}},computed:{},methods:{validator(e){return"string"===typeof e&&e.match(/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/)},enterEditMode(){return this.$children[0].enterEditMode()}}},ke=Ee,_e=Object(p["a"])(ke,v,x,!1,null,null,null),Pe=_e.exports,Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"entity",on:{click:function(t){return t.stopPropagation(),e.onClick(t)}}},[e.isArray?n("child-elements",{ref:"children",attrs:{value:e.value},on:{change:function(t){return e.$emit("change",t)}}}):e._e(),e.isArray||!e.isObject&&!e.hasProperties?e._e():n("properties",{ref:"children",attrs:{value:e.value},on:{change:function(t){return e.$emit("change",t)}}})],1)},je=[],Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.inline?"span":"ol",{ref:"ol",tag:"component",class:" inline-list"},e._l(e.localValue,(function(t,i){return n("child-element",{key:i,ref:"children",refInFor:!0,attrs:{index:i,spec:e.childSpec,value:t,"is-new":i===e.localValue.length-1,"new-inline-additional":i>0&&e.localValue.length-1&&e.inline,type:e.childType,inline:e.inline},on:{change:function(t){return e.onChange(i,t)},delete:function(t){return e.onDelete(i,t)},insertBefore:function(t){return e.onInsertBefore(i,t)}}})})),1)},Ce=[],Ne=function(e=!0){return{computed:{tag(){return this.$options.name}},methods:{select(){this.$el&&this.$el.classList&&(this.$el.classList.add("selected"),this.$emit("selected"))},onSelect(){this.canSelect()||this.$parent.$emit("select"),this.$select(this)},canSelect(){return("entity"!==this.$options.name||"property"!==this.$parent.$options.name)&&e},removeFromSelection(){this.$el&&this.$el.classList&&this.$el.classList.remove("selected")},getIndex(e){return this.$children.indexOf(e)}}}},qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.inline?"span":"li",{tag:"component",attrs:{"data-path":e.location.path},on:{click:function(t){return t.stopPropagation(),e.onSelect(t)}}},[e.canExpand?n("q-icon",{style:e.expanded?"":"transform: rotate(270deg)",attrs:{size:"sm",name:(e.expanded,"arrow_drop_down")},on:{click:e.onClickExpand}}):e._e(),e.inline&&!e.isNew&&0!==e.index?n("span",[e._v(" ,")]):e._e(),e.displayInline?n("inline-value",{ref:"inlineValue",attrs:{"new-inline-additional":e.newInlineAdditional,value:e.value,spec:e.computedSpec},on:{change:e.onChange,delete:function(t){return e.$emit("delete")}}}):e._e(),n("entity-actions"),n("q-slide-transition",[e.expanded?n("entity",{key:e.index,ref:"entity",attrs:{value:e.value,spec:e.computedSpec},on:{change:e.onChange}}):e._e()],1),n("selection-menu")],1)},Me=[],Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",e._l(e.entityActions,(function(t,i){return n("q-btn",{key:i,staticClass:"q-ml-md",attrs:{size:"sm",label:t.label,color:"accent",flat:"",padding:"xs",dense:"",loading:e.loading[i],icon:t.icon},on:{click:function(t){return e.execute(i)}}},[t.description?n("q-tooltip",[n("span",{domProps:{innerHTML:e._s(t.description)}})]):e._e()],1)})),1)},Ae=[],Ve=n("3c43"),De=n("0ea3"),Ke={mixins:[C],data(){return{loading:[!1],file:null}},mounted(){},computed:{entityActions(){return this.location.expectedSpec.actions||[]}},methods:{async execute(e){const t=this;try{this.$set(this.loading,e,!0),await Object(De["a"])(this.entityActions[e].action,this.location.context,{change(e){t.$emit("change",e)}})}catch(n){console.error(n),Object(Ve["notifyError"])("There was an error executing the action")}finally{this.$set(this.loading,e,!1)}}}},Fe=Ke,Qe=(n("c77e"),n("9c40")),Be=n("7d53"),Le=Object(p["a"])(Fe,Ie,Ae,!1,null,"dbd14d1a",null),He=Le.exports;f()(Le,"components",{QBtn:Qe["a"],QTooltip:z["a"],QFile:Be["a"]});var Ue={computed:{displayInline(){return!1!==this.expectedSpec.displayInline&&(!0===this.expectedSpec.displayInline||!this.computedSpec.hideName&&(!this.isHash&&(!!this.computedSpec.template||!this.isArray)))},isArray(){return Array.isArray(this.value)||this.computedSpec&&"string"===typeof this.computedSpec.type&&this.computedSpec.type.endsWith("*")},isHash(){return void 0!==this.computedSpec.hashSpec},isObject(){return this.value&&"object"===typeof this.value&&!Array.isArray(this.value)}},methods:{onSelect(){this.$select(this)},delete(){this.$emit("delete")}}},ze={name:"ChildElement",mixins:[Ne(!0),C,Ue],components:{"entity-actions":He},props:{value:{required:!0},spec:{type:Object,required:!0},index:{required:!0,type:Number},isNew:{type:Boolean,default:!1},inline:{type:Boolean,default:!1},newInlineAdditional:{type:Boolean,default:!1}},data(){return{expanded:!1}},mounted(){this.expanded=!0===this.computedSpec.expanded},computed:{firstFieldElement(){return this.$refs.entity.firstFieldElement},computedDictionary(){return E(this)},canExpand(){let e=this.location.spec;return!!Array.isArray(e.show)||!!e.hashSpec}},methods:{onClickExpand(){this.expanded=!this.expanded},onChange(e){this.$emit("change",e)},paste(e){this.$emit("insertBefore",e)},enterEditMode(){return this.$refs["inlineValue"].enterEditMode()},expand(){this.expanded||(this.expanded=!0)},child(e){return this.$refs.entity?this.$refs.entity.child(e):null}},watch:{expanded(e){e&&this.$bus("expanded")}}},Re=ze,We=(n("e580"),n("e9c1")),Ge=Object(p["a"])(Re,qe,Me,!1,null,"19f78620",null),Ze=Ge.exports;f()(Ge,"components",{QIcon:R["a"],QSlideTransition:We["a"]});var Je={name:"ChildElements",mixins:[Ne(!1),C],props:{value:{required:!0},inline:{type:Boolean,default:!1},parentPath:{required:!1,type:String,default:null}},components:{"child-element":Ze},data(){const e=Array.from(Array.isArray(this.value)?this.value:[]);return e.push(void 0),{localValue:e}},watch:{value(e){Array.isArray(e)&&(this.localValue=Array.from(e)),0!==this.value.length&&w(this.value[this.value.length-1])||this.pushNewElement()}},methods:{child(e){return this.$refs.children.find(t=>t.index===e)||null},enterEditMode(){return!!(this.$refs.children&&this.$refs.children.length>0)&&this.$refs.children[0].enterEditMode()},insertElement(e,t){Array.isArray(this.value)?this.value.splice(t,0,e):this.$emit("change",[e]),this.localValue.splice(t,0,e)},deleteElement(e){Array.isArray(this.value)&&(this.value.splice(e,1),this.localValue.splice(e,1),this.$emit("change",this.value))},pushNewElement(){let e=this.localValue.length;this.$set(this.localValue,e,void 0),Object(V["a"])("edit","insert")},onChange(e,t){if(Array.isArray(this.value))this.value.length<=e&&this.pushNewElement(),this.$set(this.localValue,e,t),this.$set(this.value,e,t),this.$emit("change",this.value);else{this.$set(this.localValue,e,t);let n=Array.from(this.localValue);this.$emit("change",n),this.pushNewElement()}},onDelete(e){this.deleteElement(e)},onInsertBefore(e,t){this.insertElement(t,e)}},computed:{type(){return this.computedSpec.type},childType(){return this.type&&this.type.endsWith("*")?this.type.substring(0,this.type.length-1):null},childSpec(){return Object(c["a"])(this.computedSpec,E(this).getTypeSpec(this.childType))},firstFieldElement(){return this.$children[0]}}},Xe=Je,Ye=(n("6b3d"),Object(p["a"])(Xe,Oe,Ce,!1,null,"6e398e5e",null)),et=Ye.exports,tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{ref:"ul"},[e._l(e.childProperties,(function(t){return n("property",{key:t.key||t.name,ref:"children",refInFor:!0,attrs:{"is-new":t.isNew,name:t.name||"",value:t.value,object:e.localValue&&"object"===typeof e.localValue?e.localValue:{}},on:{update:function(n){return e.onUpdate(t)},change:function(t){return e.$emit("change",t)},changePropertyName:function(n){return e.onChangePropertyName(n,t)},delete:function(n){return e.deleteProperty(t.name)}}})})),n("additional-properties",{attrs:{value:e.value,spec:e.computedSpec}})],2)},nt=[],it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.spec.additional?n("div",{staticClass:"additional-properties"},[e.expanded?n("div",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.toggleExpand()}}},[e._v("\n\t\t( - )\n\t")]):n("div",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.toggleExpand()}}},[e._v("\n\t\t(...)\n\t")]),e.expanded?n("div",e._l(e.childProperties,(function(t){return n("property",{key:t.name,attrs:{object:e.value,name:t.name,spec:t.spec,value:t.value}})})),1):e._e()]):e._e()},st=[],ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"property",class:{missing:e.isMissing},attrs:{"data-path":e.location.path},on:{click:function(t){return t.stopPropagation(),e.onSelect(t)}}},[e.showName?n("property-name",{ref:"propertyName",attrs:{"is-new":e.isNew,name:e.propertySpec.title||e.name,object:e.object,field:e.name,placeholder:e.location.expectedSpec.namePlaceholder},on:{change:e.onChangePropertyName}}):e._e(),e.showName?n("span",{staticClass:"property-colon"},[e._v(":")]):e._e(),e.canExpand&&(e.showName||e.displayInline)?n("q-icon",{style:e.expanded?"":"transform: rotate(270deg)",attrs:{name:"arrow_drop_down",size:"sm"},on:{click:function(t){e.explicitExpandState=!e.expanded}}}):e._e(),e.displayInline?n("inline-value",{ref:"inlineValue",attrs:{spec:e.computedSpec,object:e.object,"property-name":e.name,value:null===e.newValue?e.value:e.newValue,type:e.computedType,"inline-class":e.computedSpec.class,"is-missing":e.isMissing},on:{change:e.onChange,delete:function(t){return e.$emit("delete")}}}):e._e(),e.computedSpec.description&&e.showName?n("q-icon",{attrs:{name:"help_outline"}},[n("q-tooltip",{attrs:{anchor:"center right",self:"center left","max-width":"20em"}},[n("span",{domProps:{innerHTML:e._s(e.computedSpec.description)}})])],1):e._e(),n("entity-actions",{on:{change:e.onChange}}),n("q-slide-transition",{attrs:{appear:""}},[n("entity",{directives:[{name:"show",rawName:"v-show",value:e.expanded,expression:"expanded"}],ref:"entity",attrs:{value:null===e.newValue?e.value:e.newValue,spec:e.computedSpec,"hide-expand-control":!0,expanded:e.expanded,"inline-class":e.computedSpec.class},on:{change:e.onChange}})],1),n("selection-menu")],1)},rt=[],at=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isNew&&"edit"===e.mode?n("input",{attrs:{type:"text",placeholder:e.placeholder,validator:function(t){return!Object.keys(e.object||{}).includes(t)}},domProps:{value:e.newName},on:{input:e.onInput,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:(t.stopPropagation(),t.preventDefault(),t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onMoveToNextField(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:t.shiftKey?(t.stopPropagation(),t.preventDefault(),t.ctrlKey||t.altKey||t.metaKey?null:e.onMoveToPreviousField(t)):null}]}}):n("div",{staticClass:"property-name",style:{color:e.isNew?"grey":"black"},on:{click:e.enterEditMode}},[e._v("\n\t"+e._s(e.isNew||0===e.name.length?e.newName.length>0?e.newName:e.placeholder:e.name)+"\n")])},lt=[],ct={name:"PropertyName",data(){return{newName:"",mode:"view"}},methods:{onInput(e){this.$emit("change",e.target.value),this.newName=e.target.value},enterEditMode(){return this.mode="edit",this.$nextTick(()=>{this.$refs.input&&this.$refs.input.focus()}),!0},exitEditMode(){return this.mode="view",!0},onMoveToPreviousField(){this.exitEditMode(),this.$bus("moveToPreviousField")},onMoveToNextField(){this.exitEditMode(),this.$bus("moveToNextField")}},props:{name:{type:String,required:!0},placeholder:{type:String,default:"name"},field:{type:String,default:""},isNew:{type:Boolean,default:!1},object:{type:Object,required:!0}},computed:{isValidName(){return!Object.keys(this.object).includes(this.newName)}}},ut=ct,dt=(n("e2cb"),Object(p["a"])(ut,at,lt,!1,null,"216bbec7",null)),pt=dt.exports,ht=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{on:{click:function(t){return t.stopPropagation(),e.onClick(t)}}},[e.computedSpec.viewer?n("custom-editor",{ref:"editor",attrs:{"data-path":e.location.path,value:e.value,spec:e.computedSpec},on:{change:function(t){return e.$emit("change",t)}}}):e.computedSpec.template&&"view"===e.mode?n("span",{staticClass:"value-template",attrs:{"data-path":e.location.path}},[e._v("\n\t\t"+e._s(e.calcTemplate(e.computedSpec.template,e.value))+"\n\t")]):!e.hasNoText&&"view"===e.mode&&e.isPrimitive?n("span",{class:["value-primitive","a string"===e.location.expectedType&&"string"===typeof e.value?"string-value":"",e.computedSpec.inlineClass||""],attrs:{"data-path":e.location.path}},[n("q-tooltip",[e._v(e._s(e.placeholder))]),e._v("\n\t\t"+e._s(e.value)+"\n\t")],1):e.isReference&&"view"===e.mode?n("span",{staticClass:"reference"},[e._v("\n\t\t"+e._s(e.value.label)+"\n\t")]):!e.computedSpec.displayPattern&&!e.computedSpec.pattern||"reedit"===e.mode||e.showSuggestions?e.hasNoText&&"view"===e.mode&&e.newInlineAdditional?n("span",{staticClass:"insert-item placeholder",attrs:{"data-path":e.location.path}},[n("q-icon",{attrs:{name:"keyboard_arrow_down"}}),e.spec.description?n("q-tooltip",{attrs:{anchor:"center right",self:"center left","max-width":"20em",delay:100}},[n("span",{domProps:{innerHTML:e._s(e.spec.description)}})]):e._e()],1):e.hasNoText&&"view"===e.mode?n("span",{staticClass:"placeholder",attrs:{"data-path":e.location.path}},[e._v(e._s(e.placeholder)+"\n\t\t"),e.spec.description?n("q-tooltip",{attrs:{anchor:"center right",self:"center left","max-width":"20em",delay:100}},[n("span",{domProps:{innerHTML:e._s(e.spec.description)}})]):e._e()],1):"edit"===e.mode||"reedit"===e.mode?n("inline-editor",{attrs:{value:e.value,mode:e.mode,"data-path":e.location.path},on:{change:function(t){return e.$emit("change",t)},delete:function(t){return e.$emit("delete")}}}):n("span",{staticClass:"type-name",attrs:{"data-path":e.location.path}},[e._v(e._s(e.typeName))]):n("inline-pattern",{ref:"editor",class:e.computedSpec.inlineClass,attrs:{value:e.value,spec:e.computedSpec,"data-path":e.location.path},on:{change:function(t){return e.$emit("change",t)},edit:function(t){return e.enterEditMode(!0)}}})],1)},mt=[],ft={name:"CustomEditor",props:{value:{},spec:{required:!0,type:Object}},render(e){return e(this.spec.viewer,{ref:"editor",props:{value:this.value,spec:this.spec},on:{change:e=>{this.$emit("change",e)}}})},methods:{enterEditMode(){return!(!this.$refs.editor||"function"!==typeof this.$refs.editor.enterEditMode)&&this.$refs.editor.enterEditMode()},exitEditMode(){this.$refs.editor&&"function"===typeof this.$refs.editor.exitEditMode&&this.$refs.editor.exitEditMode()}}},yt=n("8f8a"),gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-dialog",{ref:"dialog",on:{hide:e.onDialogHide}},[n("q-card",{staticClass:"q-dialog-plugin"},[n("q-card-section",{staticClass:"bg-primary text-white q-pa-xs"},[n("div",{staticClass:"text-h6 "},[e._v("\n\t\t\t\tDiagnostics for "+e._s(e.location.path)+"\n\t\t\t")])]),n("q-card-section",[n("div",[e._v("Expected type is: "+e._s(e.location.expectedType))]),n("div",[e._v("calculated type is: "+e._s(e.location.type))])]),n("q-card-actions",[n("q-btn",{attrs:{color:"primary",label:"Context"},on:{click:e.onDumpContext}}),n("q-btn",{attrs:{color:"primary",label:"Suggestions"},on:{click:e.onDumpSuggestions}}),n("q-btn",{attrs:{color:"primary",label:"OK"},on:{click:e.onOKClick}})],1)],1)],1)},vt=[],xt=n("00ff"),bt={mixins:[C],mounted(){},props:{},methods:{show(){this.$refs.dialog.show()},onDumpSuggestions(){console.info("Dumping Suggestions ==========>"),Object(I["a"])(this.location,"").list.forEach(e=>{console.info(e.source,e.text,e)}),console.info("=================================")},onDumpContext(){console.info("DUMPING CONTEXT AT",this.location.path),Object(xt["b"])(this.location,({type:e,name:t,value:n})=>{console.info(`${t} (${e}) ==>`,n)},void 0,void 0,"",(e,t,n)=>{console.info(e.toUpperCase(),t.path||"/",n||"","===============")}),console.info("====================================================")},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){this.$emit("ok"),this.hide()},onCancelClick(){this.hide()}}},St=bt,$t=n("24e8"),wt=n("f09f"),Et=n("a370"),kt=n("4b7e"),_t=Object(p["a"])(St,gt,vt,!1,null,null,null),Pt=_t.exports;f()(_t,"components",{QDialog:$t["a"],QCard:wt["a"],QCardSection:Et["a"],QCardActions:kt["a"],QBtn:Qe["a"]});var Tt={name:"InlineValue",mixins:[C],components:{"custom-editor":ft},props:{value:{required:!0},spec:{required:!0,type:Object},name:{required:!1,type:String,default:null},readonly:{required:!1,type:Boolean,default:!1},isMissing:{required:!1,type:Boolean,default:!1},newInlineAdditional:{type:Boolean,default:!1}},data(){return{mode:"view"}},mounted(){this.$el.addEventListener("click",e=>{this.$select(),this.$bus("enterEditMode"),e.stopPropagation()})},updated(){},computed:{hasNoText(){return w(this.value)||"string"===typeof this.value&&0===this.value.length},hasText(){return!this.hasNoText},isPrimitive(){return j(this.value)},isReference(){return"reference"===Object(c["f"])(this.computedSpec)},typeName(){return Object(c["f"])(this.computedSpec)},placeholder(){return Object(c["b"])(this.location.expectedSpec,this.name)},showSuggestions(){return this.canUseExpression&&void 0===this.value}},methods:{onClick(e){e.ctrlKey,this.$select(this)},showDiagnostics(){this.$q.dialog({component:Pt,parent:this,title:this.location.path}),console.info("Location",this.location),console.info("Dictionary",this.location.dictionary)},enterEditMode(e=!1){return!this.readonly&&!this.location.isReadOnly&&(this.mode=e?"reedit":"edit",void 0!==this.value&&this.isReference&&(this.mode="reedit"),!this.$refs.editor||"function"!==typeof this.$refs.editor.enterEditMode||this.$refs.editor.enterEditMode())},exitEditMode(){this.mode="view"},calcTemplate(e,t){return Object(yt["a"])(e,t)}}},jt=Tt,Ot=(n("7e66"),n("58a8")),Ct=Object(p["a"])(jt,ht,mt,!1,null,"2e8be70e",null),Nt=Ct.exports;f()(Ct,"components",{QTooltip:z["a"],QIcon:R["a"],QBadge:Ot["a"]});var qt={name:"Property",components:{"property-name":pt,"inline-value":Nt,"entity-actions":He},props:{name:{type:String,required:!0},value:{required:!0},object:{type:Object,required:!0},isNew:{type:Boolean,default:!1}},mixins:[Ne(!0),C,Ue],data:function(){return{newPropertyName:null,newValue:null,explicitExpandState:null}},watch:{expanded(e){e&&this.$bus("expanded")}},computed:{isRequired(){return!0===this.propertySpec.required},isMissing(){if(this.isRequired){const e=this.location.value;if(void 0===e)return!0;if(Array.isArray(e)&&0===e.length)return!0}return!1},isEmpty(){return void 0===this.location.value},expanded(){return null!==this.explicitExpandState?this.explicitExpandState:this.computedSpec.expanded||!1},canExpand(){if(this.value&&"object"===typeof this.value&&this.value.$type){let e=E(this).getTypeSpec(this.value.$type);if(Array.isArray(e.show)&&e.show.length>0)return!0}return!!this.isArray||(!!(Array.isArray(this.computedSpec.show)&&this.computedSpec.show.length>0)||!!this.isHash)},firstFieldElement(){return this.$refs.entity.firstFieldElement},showName(){return!0!==this.computedSpec.hideName},propertySpec(){try{return this.location.parent.spec.properties[this.name]||{}}catch{return{}}}},methods:{onChangePropertyName(e){this.$emit("changePropertyName",{oldVal:this.newPropertyName,newVal:e}),this.newPropertyName=e},onToggleExpand(){this.explicitExpandState=!this.expanded},onChange(e){this.name||(Object(ee["j"])(this.newPropertyName,ee["g"],"Cannot set a value when the property name is not set yet"),Object(ee["j"])(void 0===this.object[this.newPropertyName],ee["a"],'A property with the name "'+this.newPropertyName+'" already exists')),this.object[this.newPropertyName||this.name]!==e&&(this.$set(this.object,this.newPropertyName||this.name,e),this.$emit("update"))},child(e){return this.$refs.entity?this.$refs.entity.child(e):null},enterEditMode(){return this.isNew?this.$refs.propertyName.enterEditMode():this.$refs.inlineValue?this.$refs.inlineValue.enterEditMode():(this.explicitExpandState=!0,!!this.$refs.entity&&(this.$nextTick(()=>this.$refs.entity.enterEditMode()),!0))},expand(){this.explicitExpandState=!0}}},Mt=qt,It=(n("add7"),Object(p["a"])(Mt,ot,rt,!1,null,"f1a141ce",null)),At=It.exports;f()(It,"components",{QIcon:R["a"],QTooltip:z["a"],QSlideTransition:We["a"]});var Vt={name:"AdditionalProperties",components:{property:At},mixins:[Ne(!0),C],props:{value:{required:!0},spec:{required:!0,type:Object}},data(){return{expanded:!1}},computed:{childProperties(){return Object($["a"])(this.location,this.spec.additional)}},methods:{toggleExpand(){this.expanded=!this.expanded}}},Dt=Vt,Kt=Object(p["a"])(Dt,it,st,!1,null,null,null),Ft=Kt.exports,Qt={name:"Properties",mixins:[Ne(!0),C],components:{"additional-properties":Ft,property:At},props:{value:{default:void 0}},data(){return{localValue:null,childProperties:[]}},mounted(){this.localValue=this.value||(this.isHash?{}:Object($["b"])(this.computedType,null,E(this))),this.updateChildProperties()},watch:{value(e){this.localValue=e},computedSpec(){this.updateChildProperties()},localValue(){this.updateChildProperties()}},computed:{isHash(){return void 0!==this.computedSpec.hashSpec},firstFieldElement(){return this.$children.length>1?this.$children[1]:null}},methods:{onChangePropertyName({newVal:e},t){t.name=e},onUpdate(e){this.$set(e,"value",this.localValue[e.name]),this.$emit("change",this.localValue)},child(e){return this.$refs.children.find(t=>t.name===e)||null},updateChildProperties(){const e=Object($["a"])(this.location);this.childProperties.forEach(e=>e.updated=!1),e.forEach(e=>{const t=this.childProperties.find(t=>t.name===e.name);t?(t.value=e.value,t.isNew=!1,t.updated=!0,t.isNew=!1):this.childProperties.push(e)});for(let n=this.childProperties.length-1;n>=0;--n)!1!==this.childProperties[n].updated||this.childProperties[n].isNew||this.childProperties.splice(n,1);const t=this.computedSpec.show;Array.isArray(t)&&this.childProperties.sort((e,n)=>t.indexOf(e.name)-t.indexOf(n.name)),this.isHash&&void 0===this.childProperties.find(e=>e.isNew)&&!this.location.isReadOnly&&this.childProperties.push({key:"$$$"+Object($["d"])(),isNew:!0})},deleteProperty(e){delete this.value[e],this.updateChildProperties()},enterEditMode(){return!!this.firstFieldElement&&this.firstFieldElement.enterEditMode()}}},Bt=Qt,Lt=Object(p["a"])(Bt,tt,nt,!1,null,null,null),Ht=Lt.exports,Ut={name:"Entity",mixins:[Ne(!0),C],components:{properties:Ht,"child-elements":et},props:{value:{required:!0},parentPath:{required:!1,type:String,default:null}},computed:{isArray(){return!!Array.isArray(this.value)||(!("string"!==typeof this.computedType||!this.computedType.endsWith("*"))||!(null===this.computedSpec||"string"!==typeof this.computedSpec.type||!this.computedSpec.type.endsWith("*")))},hasProperties(){return void 0!==this.computedSpec.properties},isObject(){return!(!this.computedSpec.show&&!this.computedSpec.hashSpec)||this.value&&"object"===typeof this.value&&!Array.isArray(this.value)},firstFieldElement(){return this.$refs.children.firstFieldElement}},methods:{onClick(){this.$select(this)},child(e){const t=this.$refs.children;return t.child(e)},enterEditMode(){return this.$refs.children?this.$refs.children.enterEditMode():!!this.$refs.properties&&this.$refs.properties.enterEditMode()}}},zt=Ut,Rt=(n("c1c4"),Object(p["a"])(zt,Te,je,!1,null,"c3b5cc40",null)),Wt=Rt.exports,Gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-menu",{attrs:{"context-menu":""},on:{"before-show":e.checkIfSelected}},[e.show?n("q-list",{attrs:{dense:""}},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",dense:""},on:{click:e.onCut}},[n("q-item-section",[e._v("Cut")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",dense:""},on:{click:e.onCopy}},[n("q-item-section",[e._v("Copy")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",dense:"",disabled:!e.$select.canPaste(e.$parent)},on:{click:e.onPaste}},[n("q-item-section",[e._v("Paste")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",dense:""},on:{click:e.onInsert}},[n("q-item-section",[e._v("Insert")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",dense:""},on:{click:e.onInsertNew}},[n("q-item-section",[e._v("Insert New")])],1)],1):e._e()],1)},Zt=[],Jt={name:"SelectionMenu",methods:{onCut(){this.$select.cut(this.$parent)},onPaste(){this.$select.paste(this.$parent)},onInsert(){this.$select.insert(this.$parent)},onInsertNew(){this.$select.insertNew(this.$parent)},onCopy(){this.$select.copy(this.$parent)},isSelected(){return this.$select.isSelected(this.$parent)},checkIfSelected(){this.isSelected()?this.show=!0:this.show=!1}},computed:{},data(){return{show:!1}}},Xt=Jt,Yt=n("1c1c"),en=Object(p["a"])(Xt,Gt,Zt,!1,null,null,null),tn=en.exports;f()(en,"components",{QMenu:L["a"],QList:Yt["a"],QItem:H["a"],QItemSection:U["a"]}),f()(en,"directives",{ClosePopup:W["a"]});var nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",e._l(e.elements,(function(t,i){return n("span",{key:i},["object"===typeof t?n("span",[e.isCollection(t)?n("child-elements",{ref:"field",refInFor:!0,attrs:{value:e.propertyValue(t),"parent-path":e.location.path+"/"+t.name,inline:""},on:{change:function(n){return e.onChange(t.name,n)}}}):n("inline-value",{ref:"field",refInFor:!0,staticClass:"field",style:e.propertySpec(t).style,attrs:{value:e.propertyValue(t),spec:e.propertySpec(t),name:t.name},on:{change:function(n){return e.onChange(t.name,n)}}}),"expanded"===e.detailState[i]?n("q-icon",{staticStyle:{"vertical-align":"super"},attrs:{name:"remove_circle_outline"},on:{click:function(t){return t.stopPropagation(),e.onCollapse(i)}}}):e._e(),"collapsed"===e.detailState[i]?n("q-icon",{staticStyle:{"vertical-align":"super"},attrs:{name:"add_circle_outline"},on:{click:function(t){return t.stopPropagation(),e.onExpand(i)}}}):e._e(),n("q-slide-transition",[n("entity",{directives:[{name:"show",rawName:"v-show",value:"expanded"===e.detailState[i],expression:"detailState[index]==='expanded'"}],attrs:{value:e.propertyValue(t),"parent-path":e.path+"/"+t.name}})],1)],1):n("span",{on:{click:e.onClickTextArea}},[e._v(e._s(t)+"\n\t\t")])])})),0)},sn=[],on=n("ade6"),rn={components:{childElements:et},name:"InlinePattern",mixins:[C],props:{value:{required:!0},spec:{required:!0,type:Object}},data(){return{detailState:[]}},mounted(){this.initializeDetailState()},computed:{elements(){return Object(X["a"])(Object(c["c"])(this.computedSpec)).elements}},methods:{onClickTextArea(){this.$emit("edit")},onCollapse(e){this.$set(this.detailState,e,"collapsed")},onExpand(e){this.$set(this.detailState,e,"expanded")},initializeDetailState(){this.detailState=this.elements.map(e=>{const t=e.name;if(!this.value||"object"!==typeof this.value)return"none";{const e=this.value[t];if(e&&"object"===typeof e&&e.$type){const t=this.location.dictionary.getTypeSpec(e.$type);return t.inlineDetails||"none"}}})},enterEditMode(){return!!(Array.isArray(this.$refs.field)&&this.$refs.field.length>0&&"function"===typeof this.$refs.field[0].enterEditMode)&&this.$refs.field[0].enterEditMode()},onChange(e,t){if("object"===typeof this.value&&null!==this.value){this.$set(this.value,e,t);const n=this.elements.findIndex(t=>t&&"object"===typeof t&&t.name===e);if(n>=0&&void 0===this.detailState[n]&&t&&"object"===typeof t&&t.$type){const e=this.location.dictionary.getTypeSpec(t.$type);this.detailState[n]=e.inlineDetails}this.$emit("change",this.value)}else{const n=Object($["b"])(this.computedSpec.type,null,E(this));n[e]=t,this.$emit("change",n),this.$nextTick(()=>this.initializeDetailState())}},propertyValue(e){return this.location.child(e.name).value},propertySpec(e){const t=E(this).getTypeSpec(e.type);return this.computedSpec.properties?Object(c["a"])(this.computedSpec.properties[e.name],t):t},propertyType(e){return this.location.child(e.name).spec.type},isCollection(e){return Object(on["a"])(this.propertyType(e),this.location).isCollection}}},an=rn,ln=Object(p["a"])(an,nn,sn,!1,null,"4358afdd",null),cn=ln.exports;f()(ln,"components",{QIcon:R["a"],QSlideTransition:We["a"]});var un=n("1c16");Y["a"].$on("enterEditMode",({component:e})=>{if(Object(ee["h"])(e),"view"===e.mode){if(e.readonly||e.location.isReadOnly)return;e.enterEditMode()}}),Y["a"].$on("exitEditMode",({component:e})=>{Object(ee["h"])(e);let t=_(e,"InlineValue");t&&(t.mode="view")});var dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("input",{attrs:{type:"checkbox"},domProps:{checked:!0===e.value},on:{input:e.onChange}})},pn=[],hn={name:"BooleanViewer",props:{value:{type:Boolean}},data(){return{}},methods:{onChange(e){this.$emit("change",e.srcElement.checked)}}},mn=hn,fn=Object(p["a"])(mn,dn,pn,!1,null,null,null),yn=fn.exports;r["default"].component("richtext-editor",g),r["default"].component("boolean-viewer",yn),r["default"].component("entity",Wt),r["default"].component("inline-value",Nt),r["default"].component("selection-menu",tn),r["default"].component("url-editor",Pe),r["default"].component("inline-editor",we),r["default"].component("inline-pattern",cn);var gn={components:{entity:Wt},props:{doc:{type:Object,required:!0},type:{type:String,required:!0},packages:{type:Array,default:()=>[]},loadDocToDictionary:{type:Boolean,default:!1},frame:{type:Boolean,default:!1},useDictionary:{type:Object,default:null}},name:"Editor",data(){return{dictionary:this.useDictionary||new o["a"]}},async mounted(){this.useDictionary||(this.dictionary.setPackages(this.packages),await this.dictionary.load(this.loadDocToDictionary?this.doc:void 0))},watch:{doc:{deep:!0,handler:Object(un["a"])((async function(e){return this.updateDoc(e)}),3e3)},packages(e){this.dictionary.setPackages(e),this.dictionary.reload()}},computed:{spec(){return this.type&&this.dictionary.isInitiated()?this.dictionary.getTypeSpec(this.type):{type:this.type}},notDictionary(){return this.dictionary.getTypeSpec(this.type).notDictionary||!1}},methods:{async updateDoc(e){this.loadDocToDictionary&&!this.notDictionary&&await this.dictionary.reload(e),this.$emit("update",this.doc)},async reload(){await this.dictionary.reload()},enterEditMode(){this.$refs.entity.enterEditMode()}}},vn=gn,xn=(n("a000"),Object(p["a"])(vn,i,s,!1,null,null,null));t["a"]=xn.exports},add7:function(e,t,n){"use strict";var i=n("3921"),s=n.n(i);s.a},b0c6:function(e,t,n){},c1c4:function(e,t,n){"use strict";var i=n("c7ce"),s=n.n(i);s.a},c714:function(e,t,n){"use strict";var i=n("81d8"),s=n.n(i);s.a},c77e:function(e,t,n){"use strict";var i=n("1cfc"),s=n.n(i);s.a},c7ce:function(e,t,n){},c8ba0:function(e,t,n){},d341:function(e,t,n){},d5ca:function(e,t,n){"use strict";var i=n("748a"),s=n.n(i);s.a},e2cb:function(e,t,n){"use strict";var i=n("d341"),s=n.n(i);s.a},e580:function(e,t,n){"use strict";var i=n("b0c6"),s=n.n(i);s.a}}]);